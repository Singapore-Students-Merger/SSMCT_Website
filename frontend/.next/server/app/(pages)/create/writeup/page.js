(()=>{var e={};e.id=6070,e.ids=[6070],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},33873:e=>{"use strict";e.exports=require("path")},11723:e=>{"use strict";e.exports=require("querystring")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},70624:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=t(70260),i=t(28203),a=t(25155),n=t.n(a),l=t(67292),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(r,o);let d=["",{children:["(pages)",{children:["create",{children:["writeup",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,42361)),"C:\\Users\\czhon\\Documents\\GitHub\\SSMCT_Website\\frontend\\src\\app\\(pages)\\create\\writeup\\page.tsx"]}]},{}]},{}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,51520))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,71354)),"C:\\Users\\czhon\\Documents\\GitHub\\SSMCT_Website\\frontend\\src\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,21154)),"C:\\Users\\czhon\\Documents\\GitHub\\SSMCT_Website\\frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,51520))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\czhon\\Documents\\GitHub\\SSMCT_Website\\frontend\\src\\app\\(pages)\\create\\writeup\\page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/(pages)/create/writeup/page",pathname:"/create/writeup",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},16542:(e,r,t)=>{Promise.resolve().then(t.bind(t,42406))},8294:(e,r,t)=>{Promise.resolve().then(t.bind(t,24394))},24394:(e,r,t)=>{"use strict";t.d(r,{default:()=>p});var s=t(45512),i=t(32692),a=t(87010),n=t(86397),l=t(62149),o=t(22403),d=t(58009),c=t(46239),u=t(81441);function p(){let[e,r]=(0,d.useState)([]),[t,p]=(0,d.useState)([]),[m,x]=(0,d.useState)([]),[h,f]=(0,d.useState)(null),[g,b]=(0,d.useState)(null),[v,y]=(0,d.useState)(null),[j,C]=(0,d.useState)([]),[w,S]=(0,d.useState)(""),[D,N]=(0,d.useState)({Title:"",Difficulty:"",Link:"",Category:"",Topics:[],Description:""}),_=e=>{C(r=>{let t=r.includes(e)?r.filter(r=>r!==e):[...r,e];return N(e=>({...e,Topics:t})),t})},T=e=>{let{name:r,value:t}=e.target;N(e=>({...e,[r]:t}))};async function q(e){e.preventDefault();try{let e=new FormData;e.append("Title",D.Title),e.append("Difficulty",D.Difficulty||""),e.append("Link",D.Link),e.append("Category",D.Category||""),e.append("Topics",JSON.stringify(D.Topics)),e.append("CTF",JSON.stringify(v)),e.append("Description",D.Description),h&&e.append("WriteupThumbnail",h),g&&e.append("WriteupFile",g);let r=fetch("/api/create/writeup",{method:"POST",body:e}).then(e=>e.json()).then(e=>{if("success"===e.status)N({Title:"",Difficulty:"",Link:"",Category:"",Topics:[],Description:""});else if("error"===e.status)throw Error(e.error);return e});o.Ay.promise(r,{loading:"Creating writeup...",success:"Writeup successfully created",error:e=>`Failed to create writeup: ${e.message}`})}catch(e){console.error("Error during submit:",e)}}let[k,P]=(0,d.useState)(!1);return k?(console.log(v),(0,s.jsxs)(i.A,{gradientPosition:"center",className:"p-10",children:[(0,s.jsx)("h1",{className:"text-[3rem] font-bold",children:"Create Writeup"}),(0,s.jsx)(o.Toaster,{}),(0,s.jsxs)("form",{onSubmit:q,className:"grid grid-cols-3 grid-rows-[6rem_6rem_6rem_6rem_6rem_6rem] my-5 gap-y-0 gap-x-10",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(a.A,{placeholder:"Title",version:"secondary",className:"rounded-xl",name:"Title",value:D.Title,onChange:T,required:!0}),(0,s.jsx)("label",{children:"Title"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(n.A,{className:"rounded-xl h-[3rem] text-left",placeholder:"Select Difficulty",name:"Difficulty",options:[{value:"",label:"Select Difficulty"},{value:"Easy",label:"Easy"},{value:"Medium",label:"Medium"},{value:"Hard",label:"Hard"},{value:"Insane",label:"Insane"},{value:"Impossible",label:"Impossible"}],onChange:e=>{e?N(r=>({...r,Difficulty:e.value})):N(e=>({...e,Difficulty:""}))},required:!0}),(0,s.jsx)("label",{children:"Difficulty"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(a.A,{placeholder:"Link to challenge source",version:"secondary",className:"rounded-xl",name:"Link",value:D.Link,onChange:T,required:!0}),(0,s.jsx)("label",{children:"Source"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(n.A,{className:"rounded-xl h-[3rem] text-left",placeholder:"Select Category",options:e,name:"Category",onChange:e=>{e?N(r=>({...r,Category:e.value})):N(e=>({...e,Category:""}))},required:!0}),(0,s.jsx)("label",{children:"Category"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 row-span-5",children:[(0,s.jsxs)("div",{className:"rounded-xl h-[calc(28rem+2px)]  bg-secondary-tier1/50 border-2 border-secondary-tier2",children:[(0,s.jsx)(a.A,{onChange:e=>{S(e.target.value)},value:w,className:"h-[3rem] items-center px-4 text-primary flex text-lg rounded-b-none rounded-t-xl",placeholder:"Search Topics"}),(0,s.jsx)("div",{className:"overflow-auto text-primary h-[calc(25rem-2px)] rounded-none rounded-bl-xl rounded-br-xl w-[100%] bg-secondary-tier3 resize-none",children:t.map((e,r)=>e.name.toLowerCase().includes(w.toLowerCase())?(0,s.jsx)("span",{className:`rounded-full py-1 my-2 px-3 mx-1 inline-block bg-secondary-tier1/50 hover:cursor-pointer hover:brightness-125 ${j.includes(e.id)?"bg-primary-tier1 text-white":"bg-secondary-tier1/50 text-primary"}`,onClick:()=>_(e.id),children:e.name},r):null)})]}),(0,s.jsx)("label",{children:"Topics"})]}),(0,s.jsx)(c.A,{accept:"image/*",onFileUpload:e=>{e&&f(e)},label:"Writeup Thumbnail",file:h}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(u.A,{options:m.map(e=>({label:e.title,id:e.id})),setSelectedOption:e=>{e?y({title:e.label,id:e.id}):y(null)},placeholder:"CTF"}),(0,s.jsxs)("label",{children:["Related CTF ",!v?.id&&(0,s.jsx)("span",{className:"text-red-500 text-sm",children:"(CTF not found. It will be created.)"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 row-span-3 justify-start items-start",children:[(0,s.jsx)("textarea",{className:"text-primary placeholder-primary h-[20rem] rounded-xl w-[100%] bg-secondary-tier3 resize-none border-2 border-secondary-tier2 px-4 py-2 text-lg",placeholder:"Description",name:"Description",value:D.Description,onChange:T,required:!0}),(0,s.jsx)("label",{children:"Description"})]}),(0,s.jsx)(c.A,{accept:".md,.markdown",onFileUpload:e=>{e&&b(e)},label:"Writeup File",file:g}),(0,s.jsx)(l.A,{type:"submit",className:"row-span-1 h-[3rem] rounded-xl mt-[1rem]",children:"Create"})]})]})):null}},81441:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var s=t(45512),i=t(58009),a=t(87010);let n=({option:e,setOption:r})=>(0,s.jsx)("div",{className:"font-bold cursor-pointer flex items-center gap-2 w-full py-2 px-4 hover:brightness-90 hover:backdrop-brightness-90",onClick:()=>{console.log(e.label),r(e.label)},children:(0,s.jsx)("span",{children:e.label})}),l=({className:e,options:r,setSelectedOption:t,placeholder:l})=>{console.log(r);let[o,d]=(0,i.useState)(""),[c,u]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let e=r.find(e=>e.label===o);e?t(e):t({label:o,id:null})},[o]),(0,s.jsxs)("div",{className:`${e} relative`,children:[(0,s.jsx)(a.A,{value:o,onChange:e=>{d(e.target.value)},className:"rounded-xl",placeholder:l,onFocus:()=>{u(!0)},onBlur:()=>{setTimeout(()=>{u(!1)},100)}}),c&&(0,s.jsx)("div",{className:"overflow-auto flex flex-col absolute top-full left-0 bg-[#3f6473] rounded-xl w-full max-h-[33vh] h-fit",children:r.map(e=>{if(e.label.toLowerCase().includes(o.toLowerCase()))return(0,s.jsx)(n,{option:e,setOption:d},e.id??e.label)})})]})}},46239:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var s=t(45512),i=t(58009),a=t.n(i),n=t(45103);let l=({onFileUpload:e,label:r,file:t,accept:i})=>{let[l,o]=a().useState(null);return console.log(t),(0,s.jsxs)("div",{className:"flex flex-col gap-2 row-span-2",children:[(0,s.jsxs)("div",{className:"relative rounded-xl h-[calc(9rem+2px)] bg-secondary-tier1/50 z-10 border-2 border-secondary-tier2",children:[(0,s.jsxs)("div",{className:"flex flex-row h-[3rem] items-center",children:[(0,s.jsx)("p",{className:"px-4 text-primary text-lg",children:r}),(0,s.jsx)(n.default,{src:"/assets/record.png",className:"h-[1.5rem] w-[1.5rem] m-auto mr-3 block",height:3,width:3,alt:"upload"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center text-primary h-[calc(6rem-2px)] rounded-none rounded-bl-xl rounded-br-xl w-full bg-secondary-tier3 resize-none",children:[(0,s.jsx)("input",{type:"file",className:"top-0 absolute opacity-0 w-full rounded-none rounded-bl-xl rounded-br-xl h-full",onChange:r=>{let t=r.target.files?.[0]||null;e(t),t&&t.type.startsWith("image/")&&o(URL.createObjectURL(t))},name:"WriteupFile",accept:i,required:!0}),l?(0,s.jsx)(n.default,{src:l,alt:"Preview",className:"rounded-sm h-full",layout:"fill"}):t&&(0,s.jsx)("p",{className:"text-primary text-lg text-center",children:t.name})]})]}),(0,s.jsx)("label",{htmlFor:"WriteupFile",children:r})]})}},42361:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>o,dynamic:()=>l});var s=t(62740),i=t(42406),a=t(85562),n=t(31831);let l="force-dynamic";async function o(){return await (0,a.j)()||(0,n.redirect)("/auth/signin"),(0,s.jsx)(i.default,{})}},85562:(e,r,t)=>{"use strict";t.d(r,{$:()=>o,j:()=>d});var s=t(51825),i=t(64912),a=t(86259),n=t(84908);let l=async e=>{let r=process.env.DISCORD_GUILD_ID,t=await fetch("https://discord.com/api/v10/users/@me/guilds",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw console.error("Failed to fetch user's Discord guilds"),Error("Failed to fetch user's Discord guilds");return!!(await t.json()).some(e=>e.id===r)||(console.error("User is not in the required Discord guild"),!1)},o={adapter:(0,a.y)(n.A),pages:{signIn:"/",signOut:"/auth/signout",error:"/auth/signin",newUser:"/auth/new_user"},session:{strategy:"database"},providers:[(0,i.A)({clientId:process.env.DISCORD_CLIENT_ID,clientSecret:process.env.DISCORD_CLIENT_SECRET,authorization:{params:{scope:"identify guilds guilds.members.read"}},token:"https://discord.com/api/oauth2/token",userinfo:"https://discord.com/api/users/@me",profile:e=>({id:e.id,name:e.username,image:e.avatar?`https://cdn.discordapp.com/avatars/${e.id}/${e.avatar}.png`:null})})],callbacks:{async signIn({account:e,user:r}){if(!e||!r)return!1;if("discord"===e.provider){if(console.log(e),!e.access_token)return!1;if(!await l(e.access_token))throw Error("User is not in the required Discord guild")}return!0},session:async({session:e,user:r})=>(e?.user&&(e.user.id=r.id),e)}};function d(...e){return(0,s.getServerSession)(...e,o)}},42406:(e,r,t)=>{"use strict";t.d(r,{default:()=>s});let s=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\czhon\\\\Documents\\\\GitHub\\\\SSMCT_Website\\\\frontend\\\\src\\\\components\\\\CreateWriteupPage.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\czhon\\Documents\\GitHub\\SSMCT_Website\\frontend\\src\\components\\CreateWriteupPage.tsx","default")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,2779,8077,6622,4805,1902,8746,5147,2988],()=>t(70624));module.exports=s})();